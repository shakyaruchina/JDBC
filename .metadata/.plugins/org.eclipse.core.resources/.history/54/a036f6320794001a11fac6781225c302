package dataFetch;



import java.sql.Connection;
import java.sql.Date;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.sql.Timestamp;

import com.mysql.cj.jdbc.MysqlDataSource;

public class joinQ {

	public static void main(String[] args) throws Exception{
		MysqlDataSource dataSource = new MysqlDataSource();
		dataSource.setServerTimezone("UTC");
		String url = "jdbc:mysql://localhost:3306/demo?useUnicode=true&useJDBCCompliantTimezoneShift=true&useLegacyDateTimeCode=false&serverTimezone=UTC";
		String uname = "root";
		String pass = "macbookair";
		String query = "SELECT firstName,lastName, contactNo FROM users INNER JOIN contacts ON users.id = contacts.user_id";
	 
		Class.forName("com.mysql.cj.jdbc.Driver");
		Connection con = DriverManager.getConnection(url,uname,pass);
		
		Statement state = con.createStatement();
	 
		ResultSet rs =state.executeQuery(query);
		
		System.out.println("firstName   lastName   contactNo");
	 
		while(rs.next());
		String	firstName = rs.getString("firstName");
		String	lastName = rs.getString("lastName");
		int	contactNo = rs.getInt("contactNo");
		//java.sql.Date register_date = rs.getDate("register_date");
		
	 
			System.out.println(firstName+ "   " + lastName+"   "+ contactNo);
	 
		state.close();
	 	con.close();
}

		

	

}
